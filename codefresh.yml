version: "1.0"
stages:
  - prepare
  - prerelease
  - release
steps:
  main_clone:
    title: "Cloning main repository..."
    type: git-clone
    repo: "${{CF_REPO_OWNER}}/${{CF_REPO_NAME}}"
    revision: "${{CF_REVISION}}"
    stage: prepare
  configure_git:
    title: "Configure Git"
    image: alpine/git:latest
    commands:
      - REMOTE_URL=$(git config --get remote.origin.url)
      - CLONE_URL=${REMOTE_URL#"https://"}
      - git remote set-url origin "https://${GH_UPLIFT}@${CLONE_URL}"
      - git remote -v
    stage: prerelease
  uplift:
    title: "Release"
    stage: release
    image: "gembaadvantage/uplift"
    commands:
      - uplift release
